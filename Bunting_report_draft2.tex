\documentclass[11pt]{amsart}
\usepackage[centering]{geometry}           % See geometry.pdf to learn the layout options. There are lots.
\geometry{a4paper} % ... or a4paper or a5paper  or ... letterpaper
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an
%indent
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\usepackage{amsmath}
\usepackage{subcaption}
\usepackage{wrapfig}
\usepackage{lscape}
\usepackage{rotating}
\setlength{\rotFPtop}{0pt plus 1fil}% <- add this line after loading rotating
\setlength{\rotFPbot}{0pt plus 1fil}% <- maybe its better to add this line too
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}






\title{Stellar Oscillations Tidally Induced by a Planetary Companion}
\author{Andrew Bunting}
%\date{}                                           % Activate to display a given date or no date
%
\begin{document}

\maketitle


\begin{abstract}

A stellar oscillation code using the Henyey method to solve for the non-radial oscillations induced as a result of a companion planet's tidal potential is built and tested.

After some general testing to ensure the numerical aspect of the code produces accurate solutions, the case of a Hot Jupiter orbiting a solar-type star is tested, and is found to agree well with previously published results.  The limitations of the code are explored, including the effects of varying the semi-major axis of the planetary orbit, and of varying the resolution.

The future prospects for this project, including the application to particular physical systems, the production of predicted results of observations, and the application to non-solar-type stars such as Red Giants and White Dwarfs, are discussed.  There is scope for extending the code, broadening its range of applicability to include eccentric orbits, rotating stars and higher order modes of oscillation.

\end{abstract}


\section{Introduction} \label{Introduction}

Stars are ubiquitous in almost all areas of astrophysics, and it is becoming increasingly apparent that planets are a common occurrence as well.  My project revolves around the interaction between a subset of these two very common objects, and will enable the effect of tidally-driven stellar oscillations to be modelled, in order to assess their effect on the detection of planets.

The report is structured as follows: section \ref{Introduction} sets out the background to the project, covering Hot Jupiters, \ref{Intro:HotJupiters}, Asteroseismology, \ref{Intro:Asteroseismology}, and Computing Stellar Oscillations \ref{Intro:StellarOsc}.  Section \ref{Henyey} introduces the Henyey method, section \ref{Implement} covers the practicalities of implementing this method, and section \ref{Output} discusses the output of the code.  This is followed by a conclusion, section \ref{Conc}, and a discussion of future work, section \ref{Future}.






\subsection{Hot Jupiters} \label{Intro:HotJupiters}

In 1989 the first exoplanet was unknowingly detected by Latham \textit{et al} \cite{Latham1989}, thought at the time to be a brown dwarf, and later acknowledged as a gas giant with a minimum mass of $11$ M$_{Jup}$ \cite{Wang2012}.  This was followed by the first exoplanet discovery in 1995 \cite{Mayor1995}: 51 Pegasi b, another gas giant orbiting a solar-type star.  Since then, many more exoplanets have been discovered \cite{NASAExoplanet}, a large number of them being gas giants in close orbits \cite{Winn2014}.

The reason that selection effects favour the detection of Hot Jupiters (that is, planets of about a Jupiter mass, with semi-major axes up to approximately $0.1$ au) is due to their two primary characteristics: they are massive, and close to their star.  These effects combine to have the greatest gravitational influence on the star, giving a large radial velocity (RV) signal, as well as a wider range of angles from which a transit can be observed, and the short period of the orbits enables periodicity to be well established over a shorter time than for planets with larger semi-major axes.  Given that most early detections came through RV measurements, and the huge success of Kepler and K2 using the transit method \cite{Coughlin2016}, the current population of detected exoplanets should not be understood to be a representative sample, but its preferential selection is useful for the purposes of this project.




\subsection{Asteroseismology} \label{Intro:Asteroseismology}

Variable stars have been observed for over $3000$ years \cite{Jetsu2015}, although only in the last few centuries has the number of observed variable stars really grown \cite{Hoffleit1997}.  That stars are not constant was a major change from the classical view of the celestial sphere, and adds many layers to the complexity of stars, but also introduces new ways for us to learn about them.  Asteroseismology is the study of stellar oscillations, and is a rapidly growing field, as the quality of observations of stellar surfaces continues to improve.

Asteroseismology, understandably, first came about in studying the oscillations of our very own star -- potentially the first such vibrations were observed by Plaskett in 1916 \cite{Plaskett1916}, although at the time the observed variation in solar rotation was thought to be due to some atmospheric effects, this was shown not to be the case by Hart in 1954 \cite{Hart1954}.  Since then, thousands of solar oscillation modes have been observed, each one enabling a subtly different probe of the solar interior \cite{DiMauro2017}.  The most prominent mode has a period of around $5$ minutes, and decays rapidly (over a few periods) \cite{Ulrich1970},  and is thought to be driven by convective motions inside the sun, although this is still an area of active research.  Observations of oscillations on other stars soon followed \cite{Brown1991}, including the detection of individual modes of oscillation on $\eta$ Bootis in 1995, although this was also unclear until it was confirmed in 2003 \cite{Kjeldsen2003}.

The study of these modes of oscillation is a generalised version of the study of variable stars such as $\delta$ Scuti stars, the brightest of which oscillate in a spherically symmetric manner as opposed to the not purely radial oscillations which are harder to observe \cite{Garg2010}.  They have a clearly dominant mode of pulsation, with large variation in their physical properties (the variation in magnitude can exceed $0.5$ mag \cite{Garg2010}).  An obvious wider application of the study of stellar oscillations is the use of Cepheid variables to determine a cosmic distance scale \cite{Madore1991}.

The great benefit in studying stellar oscillations is the fact that they are oscillations throughout the body star, not merely at the surface.  This allows the interior structure of the star to be assessed much more readily than observations which depend only on the surface properties of the star.  This has been used to determine properties of stars, including precise estimates of their ages \cite{Chaplin2013} \cite{Cunha2007}.

The relevance of stellar oscillations to this project is the effect that these oscillations have on the detection of planets.  A moving stellar surface will introduce a doppler shift which varies periodically, just as the gravitational effect of the Hot Jupiter causes the periodic RV variation which enables the planet to be detected.  The flux will also be perturbed, which will cause a periodic change in the brightness of the star, which has implications for the use of photometric measurements in detecting transiting planets.


The precise nature and magnitude of these effects, and the implications for detecting further planets around such stars, is the subject of this project.  A multiplanet system would have an RV signal which is a superposition of the influence of all the planets, and would therefore include multiple different frequencies in the power spectrum, so it is important to understand precisely what modes will be excited by the first planet, in order to clearly remove its total effect from the RV signal before any subsequent detections can be assessed.  This has a twofold effect, first in preventing any false positives from higher frequency oscillations from the Hot Jupiter being designated as being due to other planets, and also reducing the background noise in the power spectrum, so that any signal not due to the Hot Jupiter could be more clearly seen.

As a secondary benefit, as it is another way to observe the system, it could be used to better constrain properties of the system.  For instance, the properties of the system, such as the semi-major axis of the planet's orbit, or the inclination of the orbit could be constrained by comparing the measured amplitude of oscillations to the modelled values.  Or, if the orbital system is already well constrained, tidal asteroseismology could be used to test the accuracy of the stellar model, and could diagnose failings in the modelling by contrasting the modelled stellar structures to observations.  There is a range of stars with Hot Jupiters which have been observed by radial velocity measurements, including some which have multiple planets \cite{NASAExoplanet}.  As objects of interest from Kepler are followed up, however, this  breadth of radial velocity measurements will increase this range \cite{Crouzet2017}.




\subsection{Computing Stellar Oscillations} \label{Intro:StellarOsc}

In order to quantitatively study these oscillations, a system of equations to describe them must be used.  In order to be able to derive this set of equations, the following assumptions must be made.

\begin{description}
\item[Time independence]
 The equilibrium structure of the star changes on a time-scale much longer than that of the oscillations.
 
 \item[Spherical symmetry]
 The equilibrium structure of the star is totally spherically symmetric, parametrised as a function only of the radius.  This enables the effective use of spherical harmonics to simplify things throughout the derivation.
 
 \item[Static state]
 Fluid velocity of the equilibrium state is negligible compared to the motions of the oscillations.
 
 \item[Cowling approximation]
 The perturbation to the self-gravity potential due to the deformation of the star in the process of oscillating is negligible compared to the perturbation which incites the oscillations.
 
 \item[Small perturbation]
 The perturbation must be small, so that the linearised regime is a valid approximation.
 
 \item[Wave solutions]
 We use wavelike solutions, with a time dependence of $e^{i m \omega t}$, where $m$ is the order of the spherical harmonic and $\omega$ is the angular frequency of the planet's orbit.
\end{description}


To start with, 12 hydrodynamic and thermodynamic equations are linearised and expressed in terms of spherical harmonics. The undesirable perturbed variables are eliminated, to leave four first order linear differential equations in terms of $\xi_{r}$, $F_{r}'$, $p'$ and $T'$; the radial displacement from the equilibrium location, perturbation to the radial flux, perturbation to the pressure and perturbation to the temperature.  A more complete derivation is given in appendix \ref{ap:Osc}.

The final form of the equations which are to be solved is as follows:


\begin{equation} \label{eq:cont_osc_dim2}
\frac{1}{\rho_{0} R}  \frac{\partial}{\partial r}\left( \rho_{0} r^{2} \tilde{\xi}_{r} \right)
+ \left( \frac{r^{2}}{\chi_{\rho} R^{2}} - \frac{l (l+1) p_{0}}{m^{2} \omega^{2} R^{2} \rho_{0} } \right) \tilde{p}
- \frac{\chi_{T}}{\chi_{\rho}} \frac{r^{2}}{R^{2}} \tilde{T}
=
\frac{l (l+1) r^{2} f}{m^{2} \omega^{2} R^{2}}
\end{equation}

\begin{multline} \label{eq:ent_osc_dim2}
i A \frac{\chi_{\rho}}{\chi_{T}} \frac{r}{R} \tilde{\xi}_{r}
+ \frac{F_{r_{BC}}}{m \omega \rho_{0} T_{0} c_{p} R^{2}} \frac{\partial}{\partial r} \left( r^{2} \tilde{F}_{r} \right)
-  i \nabla_{ad} \frac{r^{2}}{R^{2}} \tilde{p} 
+ \left( i \frac{r^{2}}{R^{2}} + \frac{l (l+1) K_{0}}{\rho_{0} m \omega c_{p} R^{2}} \right) \tilde{T}
=
0
\end{multline}

\begin{multline} \label{eq:flux_osc_dim2}
- \frac{F_{r_{BC}}}{K_{0}} \frac{\partial r}{\partial T_{0}} \tilde{F}_{r}
+ \frac{1}{\chi_{\rho}} \left( 1 + \frac{1}{\kappa_{0}} \left( \frac{\partial \kappa_{0}}{\partial \ln \rho_{0}} \right)_{T_{0}} \right) \tilde{p} \\
+ \left( - 4 + \frac{1}{\kappa_{0}} \left( \frac{\partial \kappa_{0}}{\partial \ln T_{0}} \right)_{\rho_{0}} - \frac{\chi_{T}}{\chi_{\rho}}  \left(  1 +  \frac{1}{\kappa_{0}}  \left( \frac{\partial \kappa_{0}}{\partial \ln \rho_{0}} \right)_{T_{0}} \right)    \right) \tilde{T}   -   T_{0} \frac{\partial \tilde{T}}{\partial T_{0}}
=
0
\end{multline}

\begin{equation} \label{eq:mom_osc_dim2}
- \tilde{\xi}_{r} 
+ \frac{1}{m^{2} \omega^{2} R} \left(  \frac{1}{\rho_{0}} \frac{\partial \left( p_{0} \tilde{p} \right)}{\partial r} +  \frac{g_{0}}{\chi_{\rho}} \tilde{p} \right)
- \frac{\chi_{T} g_{0}}{\chi_{\rho} m^{2} \omega^{2} R} \tilde{T}
=
- \frac{2 f}{m^{2} \omega^{2}} \frac{r}{R}
\end{equation}
\\

where the variables being solved for are:

\begin{align}
\tilde{\xi}_{r} &\equiv \frac{\xi_{r}}{R} \\
\tilde{F}_{r} &\equiv \frac{F_{r}'}{F_{r_{BC}}} \\
\tilde{p} &\equiv \frac{p'}{p_{0}} \\
\tilde{T} &\equiv \frac{T'}{T_{0}}
\end{align}
\\



The subscript $0$ refers to the equilibrium state, and primes refer to the perturbation to that equilibrium.  The variables that have not yet been defined are: $\rho$, the density; $R$, the radius at the surface of the star; $r$ the radius at that point in the star; $p$, pressure; $T$, temperature; $F_{r}$, the radiative flux; $F_{r_{BC}} = F_{r_{0}} |_{r=R}$; $l$, the degree of the spherical harmonic being solved for; $m$, the order of the spherical harmonic; $\omega$, the angular frequency of the planet's orbit; $f$, a measure of the tidal perturbation, an overview of which is in the following section;  $c_{p}$, the specific heat capacity at constant pressure; $K$, the radiative thermal conductivity; $\chi_{\rho} \equiv \left( \frac{\partial \ln p}{\partial \ln \rho} \right)_{T}$; $\chi_{T} \equiv \left( \frac{\partial \ln p}{\partial \ln T} \right)_{\rho}$; $\kappa$, the opacity; $g$, the magnitude of the gravitational acceleration; $A = \frac{N^{2}}{g_{0}} r$, as it is defined in MESA, using the Brunt-V\"{a}is\"{a}l\"{a} frequency, $N$; and $\nabla_{ad} = \left( \frac{\partial \ln T_{0}}{\partial \ln p_{0}} \right)_{s_{0}} = \frac{p_{0}}{T_{0}} \left( \frac{\partial T_{0}}{\partial p_{0}} \right)_{s_{0}}$, where $s$ is the specific entropy.

The above equations originate from the continuity equation, energy conservation, radiative diffusion equation, and momentum conservation respectively. 


The equations \ref{eq:cont_osc_dim2} to \ref{eq:mom_osc_dim2} solve for the non-adiabatic case of a perturbation expressed as a single spherical harmonic.  Any perturbation can be expressed as a sum of spherical harmonics, and the equations are linear, so the solutions can be summed.  This enables any perturbation to be broken down into its component spherical harmonics, and solved for each value of $l$ and $m$.  The full solution is then the sum of these individual solutions.  The particular form of the equations has implications for the numerical solution, and this form has been chosen as it is dimensionless, and is solved accurately in the test cases.

In this project, the perturbation is caused by the tidal potential of the companion planet, which takes the form of the non-zero terms on the right hand sides of equations \ref{eq:cont_osc_dim2} and \ref{eq:mom_osc_dim2}.  This arises from consideration of the lowest order, time-dependent, spatially varying term of the perturbing body's potential.  We work in the (non-inertial) frame centred on the star.  As such, we need not consider the first order effect of the planetary companion, which causes the motion of the star about the system's common centre of mass.

This leads to the tidal potential as:

\begin{equation} \label{eq:tidal_full}
\phi_{T} \approx - \frac{G m_{p}}{4 D}  \left( \frac{r}{D} \right)^{2}  P_{2}^{2} (\cos (\theta)) e^{2 i (\omega t - \phi)} 
\end{equation}
\\
where $\phi_{T}$ is the tidal potential; $G$ is the gravitational constant; $m_{p}$ the mass of the planet; $D$ the distance between the centre of the star and the centre of the planet; $t$, time; $\phi$, the azimuthal angle; $\theta$, the polar angle; $P_{2}^{2}(cos(\theta))$ is the associated Legendre polynomial with $l=2$ and $m=2$, equal to $3 \sin^{2}(\theta)$.

The non-radial dependence and time dependence can be cancelled out, as all the variables have it in common, leaving only the radial dependence of the perturbation:

\begin{equation}
\Phi_{P} = - \frac{G m_{p}}{4 D}  \left( \frac{r}{D} \right)^{2}  = f r^{2}
\end{equation}
\\
where $\Phi_{P}$ is the radial tidal potential, and $f = - \frac{G m_{p}}{4 D^{3}}$.














\section{The Henyey method}   \label{Henyey}

This method for solving equations was set out by Henyey \textit{et al} in 1964 \cite{Henyey1964}, as a method for computing stellar evolution. The method itself is generally applicable for the solution of the kind of equations used here (that is, four first order simultaneous differential equations), but will be explained with reference to the specific case of solving for stellar oscillations for clarity.

\subsection{A general introduction to the method}  \label{Henyey:General}

The equations to be solved are those set out in equations \ref{eq:cont_osc_dim2} to \ref{eq:mom_osc_dim2}, giving solutions for $\tilde{\xi}_{r}$, $\tilde{F}_{r}$, $\tilde{p}$ and $\tilde{T}$ all throughout the star.  The set of boundary conditions for these equations make solving them difficult -- two conditions apply at the centre of the star, and two apply at the surface:

\begin{align}
\xi_{r} &\equiv 0 \text{ at } r = 0 \\
F_{r}' &\equiv 0 \text{ at } r = 0 \\
\Delta p &\equiv  0 \text{ at } r = R \\
4 \frac{\Delta T}{T} - \frac{\Delta F}{F} &\equiv  0 \text{ at } r = R
\end{align}
\\

where $\Delta q$ is the Lagrangian derivative of some example variable, $q$.  The inner BCs demand that the oscillations are continuous at the centre, and the outer BCs demand that the pressure is unperturbed, and that the surface emits as a blackbody.

The split BCs make it difficult to work with a solution from one boundary to the other, as the problem is under-constrained until all boundary conditions can be applied.  It is this splitting of the boundary conditions, combined with the potentially highly oscillatory nature of the solutions, which means that other methods, such as the Shooting Method, would be difficult to reliably implement, and therefore we have opted for the Henyey method.

In order to simplify the maths, the equations are re-cast into vector form, with $\vec{u} = \left( \tilde{\xi}_{r}, \tilde{F}_{r} \right)^{T}$ and $\vec{v} = \left( \tilde{p}, \tilde{T} \right)^{T}$, and are expressed as finite difference equations.  Equations \ref{eq:ACD} and \ref{eq:EFH} are therefore numerical approximations to equations \ref{eq:cont_osc_dim2} and \ref{eq:ent_osc_dim2}, and \ref{eq:flux_osc_dim2} and \ref{eq:mom_osc_dim2} respectively, evaluated at the location of cell $k$.  The particular method of discretising the equations is discussed in section \ref{Implement:Disc}.  


\begin{equation} \label{eq:ACD}
\underline{A}_{k,k+1} \vec{u}_{k} + \underline{C}_{k,k+1} \vec{u}_{k+1} + \underline{D}_{k,k+1} \vec{v}_{k+1} = \vec{M}_{k,k+1},
\end{equation} 

\begin{equation} \label{eq:EFH}
\underline{E}_{k,k+1} \vec{u}_{k} + \underline{F}_{k,k+1} \vec{v}_{k} + \underline{H}_{k,k+1} \vec{v}_{k+1} = \vec{N}_{k,k+1}.
\end{equation} 
\\

where the subscripts $k$ and $k+1$ refer to adjacent cells on the numerical grid upon which the equations are being solved (there are $J$ cells, running from $k = 0$ at the centre to $k = J - 1$ at the surface of the star).  We introduce the matrices $A$, $C$, $D$, $E$, $F$ and $H$, as well as the vectors $M$ and $N$ in order to shorten the expressions, the components are given by the relevant coefficients in equations \ref{eq:cont_osc_dim2} to \ref{eq:mom_osc_dim2}.

The core of the Henyey method is how it deals with the split boundary conditions.  This is done by introducing the following relation:

\begin{equation} \label{eq:relation}
\vec{u}_{k}  + \underline{\alpha}_{k}  \vec{v}_{k}  + \vec{\gamma}_{k}  = 0,
\end{equation}
\\
where $\underline{\alpha}_{k}$ is a matrix, and $\vec{\gamma}_{k}$ a vector, which describe the relationship between $\vec{u}_{k}$ and $\vec{v}_{k}$, and are found over the course of solving the equations by using recurrence relations.  The central boundary condition dictates that $\underline{\alpha}_{0} = 0$ and $\vec{\gamma}_{0} = 0$.  From this start point, recurrence relations using equations \ref{eq:ACD}, \ref{eq:EFH} and \ref{eq:relation} are used to find expressions for $\underline{\alpha}_{k+1}$ and $\vec{\gamma}_{k+1}$.

Once the relations have been found at all points throughout the star, the outer boundary condition is used to find $\vec{u}_{J-1}$ and $\vec{v}_{J-1}$ (that is, the surface values), and another recurrence relation is used to find $\vec{u}_{k-1}$ and $\vec{v}_{k-1}$ from $\vec{u}_{k}$ and $\vec{v}_{k}$, until the solution is given throughout the whole star.  This process is shown diagrammatically in figure \ref{fig:overview}.









\begin{figure}
\begin{center}
\includegraphics[width = 0.5 \textwidth]{figures/Overview.png}
\caption{A diagrammatic overview of the Henyey method, showing what is being evaluated at each stage of the code.  The arrows represent the two recurrence relations, with the inwards arrow progressively calculating the solution as it works back towards the centre of the grid.}
\label{fig:overview}
\end{center}
\end{figure}


This code was built from scratch, and tested extensively in various situations, particularly assessing the differences between analytically equivalent expressions of the recurrence relations and the differences between different applications of the boundary conditions.  The numerical components were also extensively tested, including ensuring the accuracy of matrix and vector manipulation, particularly matrix inversion in the case of small determinants; a structure to deal with the manipulation of complex numbers was included and tested; and a method of interpolation of input data was built, such that the maximum cell size could be precisely controlled and varied across the grid.  These were used to solve a variety of different equations, ranging from simple algebraic equations up to the complex differential equations which are used to solve the stellar oscillation equations.







\section{Implementing the equations}  \label{Implement}

This section discusses the practical side of the implementation of the stellar oscillation equations, including the problems associated with that, and how they were addressed and overcome.





\subsection{Discretisation}   \label{Implement:Disc}

The code cannot work directly with analytical equations, so the equations must be expressed in a discretised form, as a function of variables defined at distinct points on the numerical grid.  This must be done in such a manner as to minimise the loss of accuracy introduced by this process.

The variables are split into two different types: cell-centre variables, defined at the centre of the cell; and cell-face variables, defined at the outer edge of the cell.  $\vec{u}$ contains cell-face variables, and $\vec{v}$ contains cell-centre variables.  This is shown in figure \ref{fig:structure}.


\begin{figure}
\begin{center}
\includegraphics[width = 0.5 \textwidth]{figures/structure.png}
\caption{A representation of two adjacent cells, $i$ and $i+1$, showing the staggered variables.  $\vec{u}_{i}$ is defined at the outer surface of cell $i$, whilst $\vec{v}_{i}$ is defined at the midpoint of cell $i$.}
\label{fig:structure}
\end{center}
\end{figure}


\begin{figure}
\begin{center}
\includegraphics[width = 0.5 \textwidth]{figures/discretisation.png}
\caption{A representation of two adjacent cells, $i$ and $i+1$, showing the interpolation of variables.  The pink crosses represent a cell-face variable, such as $\xi_{r}$, whilst the green crosses represent a cell-centre variable, such as $p'$.  The red dashed line shows the location at which equations \ref{eq:cont_osc_dim2} and \ref{eq:ent_osc_dim2}, and therefore equation \ref{eq:ACD}, are evaluated.  The pink line connecting the cell-face variables shows that, at the location of the red dashed line, the cell-face variables must be interpolated, whereas the green cross sitting exactly on the line shows that the cell-centre variable is already defined at the required location.  The blue dashed line shows the location at which equations \ref{eq:flux_osc_dim2} and \ref{eq:mom_osc_dim2}, and therefore equation \ref{eq:EFH}, are evaluated.  Similarly, the pink cross sat on the dashed line shows that the cell-face variables are defined at the required location, whereas the green line shows that the cell-centre variables must be appropriately interpolated in order to minimise inaccuracy in the equations.  Note that the unequal cell sizes requires that this interpolation must be an unevenly weighted average.}
\label{fig:discretisation}
\end{center}
\end{figure}


For the Henyey method to work, we must express the equations that we are solving (equations \ref{eq:cont_osc_dim2} to \ref{eq:mom_osc_dim2}) in terms of variables in cells $k$ and $k+1$.  To do this precisely, the location at which the equations are evaluated must be carefully considered.  Figure \ref{fig:discretisation} shows how this is done.  In order for this interpolation and the derivatives to be accurate, a sufficiently fine grid must be used, such that the linear approximation is valid.







\subsection{Input data}   \label{Implement:Input}

The equations \ref{eq:cont_osc_dim2} to \ref{eq:mom_osc_dim2} solve for small perturbations to an equilibrium model.  In order to do this, the equilibrium state of the star must be accurately known.  

To do this, I use Modules for Experiments in Stellar Astrophysics (MESA) \cite{Paxton2011} to generate $1$D, spherically symmetric models of stars.  This enables me to match the observed parameters of any system that I may seek to recreate, varying the mass, metallicity, and age of the star, amongst other things.  There is, however, some exploration required with this process, as MESA does not retrofit parameters such as brightness or surface temperature, but rather evolves the star from the initial properties.

This code outputs the equilibrium state on a grid, which defines the basic grid upon which I must solve my equations.  In order to maintain accuracy in my solution, the grid must be sufficiently fine to accurately interpolate, and also able to reliably capture any highly oscillatory behaviour in the solution (that is expected to be the radiative regions, where solutions are expected to be oscillatory, whereas they are expected to be evanescent in convective zones).  Unhelpfully, the areas in which the solution is oscillatory are areas in which MESA deems the structure to be simple, and therefore produces a low-resolution grid.

To increase the resolution, the large MESA cells must be split into smaller cells, and the data interpolated to find the appropriate values on this new grid.  This could lead to a variety of problems, including needing to be careful to strictly interpolate rather than extrapolate, and the potential for artificially large derivatives, and therefore requires careful treatment, but these problems should be avoided if the MESA grid is sufficiently fine for linear interpolation to be valid.






\subsection{Other considerations}   \label{Implement:Other}

I will outline some other problems in the implementation of the Henyey code to solve the oscillation equations here, particularly focussing on how they were overcome, or worked around.


In choosing the form of the recurrence relations used in the Henyey code, multiple different expressions for analytically equivalent versions were possible.  A major consideration was to ensure that inverting singular matrices (such as using $\underline{\alpha}_{0}^{-1}$) was avoided, which limited the possible sensible range of expressions.  Even so, these different expressions were tested to discover which versions were most effective in solving the test equations, and how to express them using the fewest matrix manipulations.  For the outgoing recurrence relation, there was only one essential expression, and all the others were found to be exactly analytically equivalent.  For the returning recurrence relation, however, two genuinely distinct options are available.  Both cases were tested and their accuracy evaluated, and case I was selected to be used.  Further details can be found in appendix \ref{ap:Henyey}.


A major obstacle to achieving the required resolution was the limitation due to the size of the available RAM.  This is a result of the fact that the process to iterate from step $k+1$ to $k$ on the return journey requires information which was used to step from $k$ to $k+1$ on the outgoing journey.  As such, each step is not stand-alone, and a large amount of memory was being used in defining each matrix at each location in the star for the entirety of the calculation.  In order to improve this situation, I introduced some new arrays which would be used specifically to exactly what would be needed for the return journey, and only that information.  Using this, each matrix array need only contain the information for the step from $k$ to $k+1$ at the time that that outward step is being evaluated, as the required information for the step from $k+1$ to $k$ on the return journey would be evaluated at that point and saved, then the matrices would be re-evaluated for the next outward step.  This introduces a few arrays of dimension $2 \times 2 \times J$, but also cuts down many arrays from the previously required $2 \times 2 \times J$ to $2 \times 2 \times 2$.  This solution does still hit another limit, however, as there are still some matrices which grow linearly with the resolution, so the RAM limitation is still in place, but at a suitable resolution (that is, $J = 20000$ rather than $J = 1000$).  Also, as the resolution is controlled as a function of position in the star, the limited number of cells can be distributed such that the highest resolution is where the need is greatest, although this is not an automatic process, but must be managed manually.







\section{Output} \label{Output}

In order to ensure that the code and equations are all correct, work from a previous paper (Terquem \textit{et al}, 1998, figure 1) has been reproduced and the output has been compared.  The previous work used a shooting method, and treated the non-adiabatic case slightly differently, but good agreement has been found between the paper's result and my own, which can be seen in figure \ref{fig:non-ad}.  Some particular differences to note are the following: the precise form of spatial oscillations in the core varies depending on the exact parameters used in the solution (which will be explored in the following paragraphs), and the behaviour at the very surface (that is, the last $\sim 0.1 \%$ of the star's radius) is significantly different, although this is due to the thin outermost radiative layer of the star, and is not thought to be a problem with the Henyey method's application in this case.



\begin{sidewaysfigure}[htbp]
\begin{center}
\begin{subfigure}{0.5\textheight}
\includegraphics[width = \textwidth]{figures/xi_r_section1_non-ad.png}
\end{subfigure}
~
\begin{subfigure}{0.5\textheight}
\includegraphics[width = \textwidth]{figures/xi_r_section2_non-ad.png}
\end{subfigure}

\begin{subfigure}{0.5\textheight}
\includegraphics[width = \textwidth]{figures/xi_r_section3_non-ad.png}
\end{subfigure}
~
\begin{subfigure}{0.5\textheight}
\includegraphics[width = \textwidth]{figures/xi_r_surface_non-ad.png}
\end{subfigure}

\caption{The full solution for the non-adiabatic case, showing the peak radial velocity (that is, $m \omega \xi_{r}$) in units of $\frac{m_{p}}{m_{p} + M_{*}}$ m s$^{-1}$, against the proportional radial distance from the centre.  Four segments have been shown, as the first three reproduce the graphs in Terquem \textit{et al}, 1998, and the fourth highlights the behaviour in the thin radiative layer at the star's surface.  As a rough guide, the y-axis is approximately in mm s$^{-1}$}
\label{fig:non-ad}
\end{center}
\end{sidewaysfigure}



To investigate some of the limitations of this solution, some of the parameters used in the solution were varied slightly, to investigate what effect this had in the different regions of the star.

Firstly, a purely physical parameter was varied by up to $1 \%$, the semi-major axis of the planet's orbit.  This would be expected to have a slight effect on the amplitude of the response throughout the star, as a more distant planetary companion would lead to a lessened tidal effect, but it would also slightly shift the frequency of the orbit, and would therefore be expected to alter the spatial frequency of oscillations within the star.  This effect can be seen in figure \ref{fig:Dvar}, where it is particularly notable that the amplitude of the spatial oscillations at the very centre varies hugely, from, effectively, $-300$ to $+500$ mm s$^{-1}$.  The overall trend, however of oscillations which grow towards the centre of the core is clearly maintained, as is the decrease in spatial frequency further from the core.  The transition to evanescent waves in the convective envelope (from $\frac{r}{R} \approx 0.7$) is consistent across the cases, and is very similar in amplitude (particularly given that the magnitude of the tidal potential varies as $D^{-3}$).  Overall, it seems that the observable behaviour is not particularly sensitive to small variations in $D$ for this case, and that the patterns of behaviour in each region are unaffected, but that one should be wary of drawing precise quantitative conclusions about the oscillations in the core.





\begin{sidewaysfigure}[htbp]
\begin{center}
\begin{subfigure}{0.5\textwidth}
\includegraphics[width = \textwidth]{figures/xi_r_section1_Dvar.png}
\end{subfigure}
~
\begin{subfigure}{0.5\textwidth}
\includegraphics[width = \textwidth]{figures/xi_r_section2_Dvar.png}
\end{subfigure}

\begin{subfigure}{0.5\textwidth}
\includegraphics[width = \textwidth]{figures/xi_r_section3_Dvar.png}
\end{subfigure}
~
\begin{subfigure}{0.5\textwidth}
\includegraphics[width = \textwidth]{figures/xi_r_surface_Dvar.png}
\end{subfigure}

\caption{The full solution for the non-adiabatic case, showing the peak radial velocity (that is, $m \omega \xi_{r}$) in units of $\frac{m_{p}}{m_{p} + M_{*}}$ m s$^{-1}$, against the proportional radial distance from the centre.  In these figures, the semi-major axis of the planetary companion's orbit has been varied slightly, leading to a small spread in both the amplitudes and spatial frequencies of the oscillations.}
\label{fig:Dvar}
\end{center}
\end{sidewaysfigure}



The other parameter which was varied was the resolution, the outputs of which are shown in figure \ref{fig:Resvar}.  In this case, a flat limit was introduced across the whole star, rather than varying it to match the needed resolution in order to try to keep things as simple as possible.  In all cases the resolution is sufficient to resolve the oscillations, (with the lowest resolution having at least 13 points covering the shortest spatial wavelength, and the highest resolution having at least 20 points).  Similar to the case of varying $D$, varying the resolution has a significant effect on the amplitude of the oscillations towards the centre of the star, but has a totally negligible effect towards the surface.  This may be partially due to the fact that the MESA skeleton of cells is already of a higher resolution than the limits used in this case for the surface, coupled with the fact that the solution is no longer oscillatory.




\begin{sidewaysfigure}[htbp]
\begin{center}
\begin{subfigure}{0.5\textwidth}
\includegraphics[width = \textwidth]{figures/xi_r_section1_Resvar.png}
\end{subfigure}
~
\begin{subfigure}{0.5\textwidth}
\includegraphics[width = \textwidth]{figures/xi_r_section2_Resvar.png}
\end{subfigure}

\begin{subfigure}{0.5\textwidth}
\includegraphics[width = \textwidth]{figures/xi_r_section3_Resvar.png}
\end{subfigure}
~
\begin{subfigure}{0.5\textwidth}
\includegraphics[width = \textwidth]{figures/xi_r_surface_Resvar.png}
\end{subfigure}

\caption{The full solution for the non-adiabatic case, showing the peak radial velocity (that is, $m \omega \xi_{r}$) in units of $\frac{m_{p}}{m_{p} + M_{*}}$ m s$^{-1}$, against the proportional radial distance from the centre.  In these figures the maximum cell size, and therefore the resolution limit of the grid, has been varied slightly, leading to a spread in the amplitudes of the oscillations.  The maximum cell size, as a proportion of the stellar radius, is plotted at $6 \times 10^{-5}$ (purple line), $7 \times 10^{-5}$ (green line), $8 \times 10^{-5}$ (blue line), and $9 \times 10^{-5}$ (orange line).}
\label{fig:Resvar}
\end{center}
\end{sidewaysfigure}





Where there is variation in the amplitude, the spatial wavelengths are still unaffected, and the overall patterns of behaviour are very similar for all the resolutions.  This is encouraging, as it shows that, although resolution may limit the extent to which we can extract precise quantitative data from the central regions, the nature and behaviour of the waves, both oscillatory and evanescent, seems to be unaffected.  As such, whilst it is clear that a higher resolution is desirable, it does not limit the usefulness of the output any more than the physical limits in the precision of the parameters of the system do (as shown in figure \ref{fig:Dvar}).


A final point to consider is the validity of the assumptions made in the derivation of the equations (listed in section \ref{Intro:StellarOsc}), to check that the solution is consistent with them.  This essentially boils down to ensuring that the perturbations are small at all points throughout the star, which can be assessed by checking the output throughout the entirety of the star.  Where this assumption is likely to break depends on the variables: $\xi_{r}$ and $F_{r}'$ are most likely to be comparable to the local equilibrium values ($r$ and $F_{r}$) towards to core of the star; $p'$ and $T'$ are most likely to comparable towards the surface.  In the case tested here, other than a few points in the value of $F_{r}'$ at the very core, all points are $\ll 1$.  These very core points are not thought to be much of an issue, as they seem to just be an edge effect, which has no apparent impact on the rest of the solution, and quickly decays away.



Overall, the code is well tested, and reproduces previous results well.  It is easy to apply to any model created in MESA, and the stability of the solution can be simply tested by investigating the effect of small variations in parameters, enabling the expected errors to be very simply and effectively assessed, and the code can be adapted and continually tested to ensure that the equations remain valid in all cases.






\section{Conclusion} \label{Conc}


Overall, the project has started well, with the production of an effective, quick and adaptable code which can be used to accurately solve the stellar oscillation equations.  The code's limitations have been explored, including both errors due to limited physical knowledge and limitations inherent in the numerical calculation.

There are many observed systems to which this code could be applied, as well as multiple different avenues of further research, which will be discussed in the section \ref{Future}.  The outputs of this code are useful, and will be able to be compared to observations soon, as they can be translated into both photometric and spectroscopic effects, which will enable the accuracy of stellar models to be tested, and will also lead to improved methods for detecting subsequent planets in systems with an observed Hot Jupiter.

Furthermore, the code is adaptable, in that the source of the perturbation could be changed in order to model another cause of oscillations, and that the code can be expanded to address different modes of oscillation, stellar rotation, or eccentric planetary orbits.







\section{Further Work}   \label{Future}

The immediate next step is to convert the calculated properties of the oscillations into relevant observables -- both in terms of the spectroscopic and photometric effects.  Spectroscopically, the Doppler shift from the motion of the surface at each point along the line of sight of the observer would be calculated to model the total lineshape as a result of the oscillations.  Photometrically, the change in shape, and the perturbed flux would contribute to a change in the total brightness of the object.  Both calculations would also need to account for the inclination of the orbit relative to the observer.  This combination of the current work with these extensions, applied to a number of known systems (such as Pegasi 51b, HD 189733 b and HD 209458 b) would form a paper over the next six months.

Work beyond that would depend on the results produced in the next few months.  One major avenue for investigation would be the use of tidally induced oscillations in exoplanet detection in the case of inclined planets -- such that transits are not observable, and RV measurements alone may be inconclusive.  Another would be the behaviour of advanced stars under tidal forcing, and the implications for multiple planet detection around such stars, which would include the study of both Red Giants and White Dwarfs.  The code could also be applied to the case of stellar binaries, and the oscillations induced on both stars would be modelled.  

The code as a whole could be broadened in its scope, by extending the realm over which the code is applicable: allowing for stellar rotation, eccentric orbits, and higher order perturbations.  This would apply to all of the above in terms of extending the relevancy and scope of research, and could enable better characterisation of systems, by being able to constrain the rotation of stars by comparing the predicted and observed results.  There are also published results regarding the modelled dynamical tides in stars as a result of rotation and eccentric orbits \cite{Burkart2012} against which the code could be once more tested and calibrated.

Overall, there are several possible, realistic and valuable avenues down which this research could continue, which could make predictions which could be used to potentially direct the use of observing time, particularly in the hunt for exoplanets, and even to test the accuracy of stellar modelling across a range of scenarios.









\section{Acknowledgements}  \label{Acknowledgements}

I would like to acknowledge the input of my supervisor, Caroline Terquem,  and of John Papaloizou, in the form of guidance and discussion throughout this project.

I would like to acknowledge MESA, \cite{Paxton2011}. http://mesa.sourceforge.net/index.html

This research has made use of the NASA Exoplanet Archive, which is operated by the California Institute of Technology, under contract with the National Aeronautics and Space Administration under the Exoplanet Exploration Program.





\bibliographystyle{plain}
\bibliography{library}









\newpage

\appendix

\section{Stellar Oscillation Equations} \label{ap:Osc}


\section{Detailed explanation of the general Henyey Method}   \label{ap:Henyey}




\end{document}  
